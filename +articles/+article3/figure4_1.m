% function figure4_1()
%% figure 4, part 1
% writen by Liangjin Song on 20210628
% the distribution function of cold ions, hot ions, and electrons at DF
%%
clear;
run('articles.article4.parameters.m');
extra.log=true;
%% the distribution function file name of cold ions, hot ions, and electrons
nic='PVh_ts102564_x1460-1505_y986-1015_z0-1';
ni='PVl_ts102564_x1460-1505_y986-1015_z0-1';
ne='PVe_ts102564_x1460-1505_y986-1015_z0-1';

%% set the figure
f=figure('Position',[500,10,1100,800]);
ha=slj.Plot.subplot(3,3,[0.09,0.09],[0.085,0.07],[0.085,0.07]);


%% for cold ions
% the speed precision
extra.precv=120;
dst=prm.read(nic);
dst=dst.dstv(prm.value.vA, extra.precv);
extra.range1=2.5;
extra.range2=2.5;
extra.range3=1.5;
plot_species_distribution_function(dst,1,ha,extra,'Vic')

%% for hot ions
% the speed precision
extra.precv=60;
dst=prm.read(ni);
dst=dst.dstv(prm.value.vA, extra.precv);
extra.range1=5;
extra.range2=5;
extra.range3=5;
plot_species_distribution_function(dst,2,ha,extra,'Vih')

%% for hot electrons
% the speed precision
extra.precv=30;
dst=prm.read(ne);
dst=dst.dstv(prm.value.vA, extra.precv);
extra.range1=18;
extra.range2=18;
extra.range3=18;
plot_species_distribution_function(dst,3,ha,extra,'Ve')

%% text box
annotation(f,'textbox',...
    [0.0863636363636363 0.886500001005828 0.051363635103811 0.0462499989941716],...
    'String',{'(a)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.395454545454545 0.886500001005828 0.0522727259858088 0.0462499989941716],...
    'String',{'(b)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.709090909090909 0.886500001005828 0.0513636351038109 0.0462499989941716],...
    'String',{'(c)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.0854545454545454 0.575250001005828 0.0522727259858088 0.0462499989941716],...
    'String',{'(d)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.393636363636364 0.575250001005827 0.051363635103811 0.0462499989941716],...
    'String',{'(e)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.709090909090909 0.576500001005827 0.0486363624578173 0.0462499989941716],...
    'String',{'(f)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.0863636363636364 0.262750001005827 0.0522727259858088 0.0462499989941716],...
    'String',{'(g)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.395454545454545 0.262750001005827 0.0522727259858088 0.0462499989941716],...
    'String',{'(h)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

annotation(f,'textbox',...
    [0.709090909090909 0.262750001005827 0.0477272715758194 0.0462499989941716],...
    'String',{'(i)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

%% save the figure
cd(outdir);
print(f,'-dpng','-r300','figure4-1.png');
print(f,'-depsc','figure4_1.eps');

%% plot the distribution function for a species
function plot_species_distribution_function(pv,np,ha,extra,sp)
extra.colormap='moon';
%% x-y
axes(ha(np));
extra.xlabel=[sp,'_x'];
extra.ylabel=[sp,'_y'];
dst=pv.intgrtv(3);
extra.xrange=[-extra.range1,extra.range1];
extra.yrange=[-extra.range1,extra.range1];
slj.Plot.field2d(dst.value, dst.ll, dst.ll,extra);
%% x-z
axes(ha(np+3));
extra.xlabel=[sp,'_x'];
extra.ylabel=[sp,'_z'];
extra.xrange=[-extra.range2,extra.range2];
extra.yrange=[-extra.range2,extra.range2];
dst=pv.intgrtv(2);
slj.Plot.field2d(dst.value, dst.ll, dst.ll,extra);
%% x-z
axes(ha(np+6));
extra.xlabel=[sp,'_y'];
extra.ylabel=[sp,'_z'];
dst=pv.intgrtv(1);
extra.xrange=[-extra.range3,extra.range3];
extra.yrange=[-extra.range3,extra.range3];
slj.Plot.field2d(dst.value, dst.ll, dst.ll,extra);
end