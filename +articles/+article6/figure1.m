%% plot figure 1, the electromagnetic fields and their profiles
%% parameters
%
clear;
indir = 'E:\Asym\cold2_ds1\data';
outdir = 'E:\Asym\cold2_ds1\out\Article\Paper6';
prm = slj.Parameters(indir, outdir);

%% time
tt = 30;

%% profile position in z-direction
pz = -0.96;

%% normalization
normE = prm.value.vA;
normB = 1;

%% read data
cd(indir);
B = prm.read('B', tt);
E = prm.read('E', tt);
ss = prm.read('stream', tt);
%% profile
lB = B.get_line2d(pz, 0, prm, normB);
lE = E.get_line2d(pz, 0, prm, normE);
%}
%% figure
f = figure('Position',[500,100,1400,800]);
h = slj.Plot.subplot(2,2,[-0.06,0.08],[0.13,0.07],[0.13,0.05]);
yrange = [-8, 8];
fontsize=16;

%% overview of Ex
axes(h(1));
hbar=slj.Plot.overview(E.x, ss, prm.value.lx, prm.value.lz, normE, []);
xlim([prm.value.lx(1), prm.value.lx(end)]);
ylim(yrange);
ylabel('Z [c/\omega_{pi}]');
caxis([-0.8, 0.8]);
set(gca,'XTicklabel',[], 'FontSize', fontsize);
set(hbar, 'Location', 'northoutside');


%% overview of Bz
axes(h(2));
hbar=slj.Plot.overview(B.z, ss, prm.value.lx, prm.value.lz, normB, []);
xlim([prm.value.lx(1), prm.value.lx(end)]);
ylim(yrange);
ylabel('Z [c/\omega_{pi}]');
set(gca,'XTicklabel',[], 'FontSize', fontsize);
set(hbar, 'Location', 'northoutside');

%% profiles of electric field
axes(h(3));
plot(prm.value.lx, lE.lx, '-r', 'LineWidth', 2);
hold on
plot(prm.value.lx, lE.ly, '-b', 'LineWidth', 2);
plot(prm.value.lx, lE.lz, '-m', 'LineWidth', 2);
plot(prm.value.lx, sqrt(lE.lx.^2 + lE.ly.^2 + lE.lz.^2), '--k', 'LineWidth', 2);
xlabel('X [c/\omega_{pi}]');
ylabel('E [B_0 v_A]');
legend('Ex', 'Ey', 'Ez', '|E|', 'Box', 'off', 'Location', 'Best');
set(gca, 'FontSize', fontsize);

%% profiles of magnetic field
axes(h(4));
plot(prm.value.lx, lB.lx, '-r', 'LineWidth', 2);
hold on
plot(prm.value.lx, lB.ly, '-b', 'LineWidth', 2);
plot(prm.value.lx, lB.lz, '-m', 'LineWidth', 2);
plot(prm.value.lx, sqrt(lB.lx.^2 + lB.ly.^2 + lB.lz.^2), '--k', 'LineWidth', 2);
xlabel('X [c/\omega_{pi}]');
ylabel('B [B_0]');
legend('Bx', 'By', 'Bz', '|B|', 'Box', 'off', 'Location', 'Best', ...
    'Position',[0.875142857387662 0.300312501862645 0.0528571423675332 0.13187499627471]);
set(gca, 'FontSize', fontsize);

%% annotation
annotation(f,'textbox',...
    [0.130714285714286 0.737750000931323 0.025714285714286 0.0437499990686775],...
    'String',{'Ex'},...
    'LineStyle','none',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'BackgroundColor',[1 1 1]);

annotation(f,'textbox',...
    [0.580714285714285 0.737750000931323 0.025714285714286 0.0437499990686775],...
    'String',{'Bz'},...
    'LineStyle','none',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'BackgroundColor',[1 1 1]);

annotation(f,'textbox',...
    [0.262142857142857 0.74625 0.0985714285714286 0.0339999999999999],...
    'String',{'magnetosheath'},...
    'LineStyle','none',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);
annotation(f,'textbox',...
    [0.262142857142857 0.57625 0.0985714285714286 0.0339999999999999],...
    'String','magnetosphere',...
    'LineStyle','none',...
    'FontSize',16,...
    'FontName','Times New Roman',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);

annotation(f,'textbox',...
    [0.0871428571428571 0.789000001005829 0.04035714186728 0.0462499989941716],...
    'String',{'(a)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');
annotation(f,'textbox',...
    [0.536428571428571 0.789000001005828 0.0410714275602784 0.0462499989941716],...
    'String',{'(b)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');
annotation(f,'textbox',...
    [0.0871428571428571 0.509000001005828 0.04035714186728 0.0462499989941716],...
    'String',{'(c)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');
annotation(f,'textbox',...
    [0.536428571428572 0.505250001005829 0.0410714275602784 0.0462499989941716],...
    'String',{'(d)'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FontName','Times New Roman');

%% save
cd(outdir);
print('-dpng', '-r300', 'figure1.png');